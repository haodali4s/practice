{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport ImageList from \"./ImageList/ImageList\";\nimport Zoom from \"./Zoom/Zoom\";\n//通过辅助函数获取数据\nimport { mapGetters } from \"vuex\";\nexport default {\n  name: \"Detail\",\n  data() {\n    return {\n      //控制商品购买个数\n      skuNum: 1\n    };\n  },\n  components: {\n    ImageList,\n    Zoom\n  },\n  mounted() {\n    //派发action:详情模块发请求需要携带商品的id\n    this.$store.dispatch(\"getDetailInfo\", this.$route.params.spid);\n  },\n  computed: {\n    ...mapGetters([\"categoryView\", \"skuInfo\", \"spuSaleAttrList\"])\n  },\n  methods: {\n    changeChecked(saleAttrValue, arr) {\n      //响应式数据:对象、数组\n      //数组的响应式数据:变更、替换【基本类型数据、引用类型对象响应式的】\n      //数组里面是基本类型数据：替换、变更    如果对象，不管你怎么玩都是相应的!!!!\n      //排他操作\n      //底下的代码:修改数组里面的对象【相应的式的】,数据变化视图跟这变化！！！\n      arr.forEach(item => {\n        item.isChecked = \"0\";\n      });\n      saleAttrValue.isChecked = \"1\";\n    },\n    //数量的表单元素的change回调\n    handler(e) {\n      //通过event事件对象获取用户输入内容[用户输入的内容一定是字符串类型的数据]\n      let value = e.target.value * 1;\n      //用户输入进来非法情况判断\n      if (isNaN(value) || value < 1) {\n        this.skuNum = 1;\n      } else {\n        //正常情况\n        this.skuNum = parseInt(value);\n      }\n    },\n    //加入购物车按钮\n    async addOrUpdateCart() {\n      //派发action:携带的载荷，分别商品的id、商品个数\n      //思考底下的这行代码实质做了一个什么事情?\n      //实质就是调用了小仓库里面相应的这个函数->addOrUpdateCart,声明部分加上asyc,这个函数执行的结构一定是Promise\n      //返回结果是一个Promise对象【三种状态:pending、成功、失败】，返回状态到底是什么，取决于这个函数addOrUpdateCart返回结果\n      try {\n        //成功干什么\n        await this.$store.dispatch(\"addOrUpdateCart\", {\n          skuId: this.$route.params.spid,\n          skuNum: this.skuNum\n        });\n        //路由跳转:携带参数,携带参数一般都是基本类型数据【字符串、数字等等】，引用类型数据白扯【传递过来路由获取不到】！！！\n        //浏览器存储功能，在路由跳转在之前，存储到浏览器中\n        // sessionStorage.setItem(\"SKUINFO\", JSON.stringify(this.skuInfo));\n        // //路由跳转\n        // this.$router.push({\n        //   path: \"/addcartsuccess\",\n        //   query: { skuNum: this.skuNum }\n        // });\n        var attribute = {};\n        for (var i of this.spuSaleAttrList) {\n          for (var j of i.spuSaleAttrValueList) {\n            if (j.isChecked == \"1\") {\n              attribute[j.saleAttrName] = j.saleAttrValueName;\n              break;\n            }\n          }\n        }\n        sessionStorage.setItem(\"other\", JSON.stringify(attribute));\n        sessionStorage.setItem(\"name\", this.skuInfo.skuDesc);\n        sessionStorage.setItem(\"id\", this.skuInfo.id);\n        sessionStorage.setItem(\"num\", this.skuNum);\n        sessionStorage.setItem(\"pic\", this.skuInfo.skuDefaultImg);\n        this.$router.push({\n          name: \"addcartsuccess\"\n        });\n      } catch (error) {\n        //失败干什么\n        alert(error);\n      }\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}