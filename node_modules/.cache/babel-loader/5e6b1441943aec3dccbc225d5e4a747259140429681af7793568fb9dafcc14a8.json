{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n//引入二维码插件\nimport QRCode from \"qrcode\";\nimport { reqPayInfo, reqPayResult } from \"@/api/index.js\";\nexport default {\n  name: \"Pay\",\n  data() {\n    return {\n      //支付相关信息:支付钱数、订单号、二维码地址\n      payInfo: {},\n      code: \"\",\n      timer: null\n    };\n  },\n  //组件挂载完毕，获取支付相关信息\n  mounted() {\n    //获取支付信息\n    this.getPayInfo();\n  },\n  methods: {\n    //立即支付按钮\n    async open() {\n      //生成一个二维码URL\n      let url = await QRCode.toDataURL(this.payInfo.codeUrl);\n      //第一个参数:即为内容区域\n      //第二个参数:标题\n      //第三个参数:组件的配置项\n      this.$alert(`<img src=${url}>`, \"请你微信扫码支付\", {\n        dangerouslyUseHTMLString: true,\n        //将字符串转换为标签\n        center: true,\n        //居中\n        showClose: false,\n        //右上角的关闭按钮不显示\n        confirmButtonText: \"支付成功\",\n        //确定按钮的文本\n        showCancelButton: true,\n        //显示取消按钮\n        cancelButtonText: \"支付遇见问题\",\n        //取消按钮的文本\n        closeOnClickModal: true,\n        //点击遮罩层关闭messagebox\n        beforeClose: (action, instance, done) => {\n          //在消息盒子关闭之前会触发\n          //action参数:可以区分用户点击的是取消【cancel】、确定【confirm】\n          //instance参数:当前消息框组件VC\n          //done参数：是一个函数,函数可以关闭消息盒子\n          if (action == \"confirm\" && this.code == 200) {\n            //清除定时器\n            clearInterval(this.timer);\n            //关闭盒子\n            done();\n            //路由跳转\n            this.$router.push(\"/paysuccess\");\n          } else if (action == \"cancel\" && this.code != 200) {\n            //清除定时器\n            clearInterval(this.timer);\n            //关闭盒子\n            done();\n            this.$message.error(\"支付遇见问题请联系超管豪哥\");\n          }\n        }\n      });\n      //查询支付结果,开启定时器每隔一段时间询问支付结果\n      this.timer = setInterval(async () => {\n        //发请求获取支付结果\n        let result = await reqPayResult(this.payInfo.orderId);\n        //返回数据当中：code=200代表支付成功  code=205未支付\n        if (result.code == 200) {\n          //支付成功了\n          //存储一下支付成功的code数值，通过他判断支付是否成功\n          this.code = result.code;\n          //清除定时器\n          clearInterval(this.timer);\n          //关闭messagebox\n          this.$msgbox.close();\n          //在路由跳转\n          this.$router.push(\"/paySuccess\");\n        } else {\n          //未支付\n          this.code = result.code;\n        }\n      }, 1000);\n    },\n    //获取支付信息\n    async getPayInfo() {\n      let result = await reqPayInfo(this.$route.query.orderId);\n      if (result.code == 200) {\n        this.payInfo = result.data;\n      }\n    }\n  }\n};","map":{"version":3,"names":["QRCode","reqPayInfo","reqPayResult","name","data","payInfo","code","timer","mounted","getPayInfo","methods","open","url","toDataURL","codeUrl","$alert","dangerouslyUseHTMLString","center","showClose","confirmButtonText","showCancelButton","cancelButtonText","closeOnClickModal","beforeClose","action","instance","done","clearInterval","$router","push","$message","error","setInterval","result","orderId","$msgbox","close","$route","query"],"sources":["src/pages/pay/index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"pay-main\">\r\n      <div class=\"pay-container\">\r\n        <div class=\"checkout-tit\">\r\n          <h4 class=\"tit-txt\">\r\n            <span class=\"success-icon\"></span>\r\n            <span class=\"success-info\">订单提交成功，请您及时付款，以便尽快为您发货~~</span>\r\n          </h4>\r\n          <div class=\"paymark\">\r\n            <span class=\"fl\">\r\n              请您在提交订单\r\n              <em class=\"orange time\">4小时</em>之内完成支付，超时订单会自动取消。订单号：\r\n              <em>\r\n                {{\r\n                payInfo.orderId\r\n                }}\r\n              </em>\r\n            </span>\r\n            <span class=\"fr\">\r\n              <em class=\"lead\">应付金额：</em>\r\n              <em class=\"orange money\">￥{{ payInfo.totalFee }}</em>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"checkout-info\">\r\n          <h4>重要说明：</h4>\r\n          <ol>\r\n            <li>\r\n              尚品汇商城支付平台目前支持\r\n              <span class=\"zfb\">支付宝</span>支付方式。\r\n            </li>\r\n            <li>其它支付渠道正在调试中，敬请期待。</li>\r\n            <li>为了保证您的购物支付流程顺利完成，请保存以下支付宝信息。</li>\r\n          </ol>\r\n          <h4>\r\n            支付宝账户信息：（很重要，\r\n            <span class=\"save\">请保存！！！</span>）\r\n          </h4>\r\n          <ul>\r\n            <li>支付帐号：11111111</li>\r\n            <li>密码：111111</li>\r\n            <li>支付密码：111111</li>\r\n          </ul>\r\n        </div>\r\n        <div class=\"checkout-steps\">\r\n          <div class=\"step-tit\">\r\n            <h5>支付平台</h5>\r\n          </div>\r\n          <div class=\"step-cont\">\r\n            <ul class=\"payType\">\r\n              <li>\r\n                <img src=\"./images/pay2.jpg\" />\r\n              </li>\r\n              <li>\r\n                <img src=\"./images/pay3.jpg\" />\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <div class=\"hr\"></div>\r\n\r\n          <div class=\"payshipInfo\">\r\n            <div class=\"step-tit\">\r\n              <h5>支付网银</h5>\r\n            </div>\r\n            <div class=\"step-cont\">\r\n              <ul class=\"payType\">\r\n                <li>\r\n                  <img src=\"./images/pay10.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay11.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay12.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay13.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay14.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay15.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay16.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay17.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay18.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay19.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay20.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay21.jpg\" />\r\n                </li>\r\n                <li>\r\n                  <img src=\"./images/pay22.jpg\" />\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div class=\"hr\"></div>\r\n\r\n          <div class=\"submit\">\r\n            <!--立即支付按钮:  -->\r\n            <a class=\"btn\" @click=\"open\">立即支付</a>\r\n          </div>\r\n          <div class=\"otherpay\">\r\n            <div class=\"step-tit\">\r\n              <h5>其他支付方式</h5>\r\n            </div>\r\n            <div class=\"step-cont\">\r\n              <span>\r\n                <a href=\"weixinpay.html\" target=\"_blank\">微信支付</a>\r\n              </span>\r\n              <span>中国银联</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//引入二维码插件\r\nimport QRCode from \"qrcode\";\r\nimport { reqPayInfo,reqPayResult} from \"@/api/index.js\";\r\nexport default {\r\n  name: \"Pay\",\r\n  data() {\r\n    return {\r\n      //支付相关信息:支付钱数、订单号、二维码地址\r\n      payInfo: {},\r\n      code: \"\",\r\n      timer: null\r\n    };\r\n  },\r\n  //组件挂载完毕，获取支付相关信息\r\n  mounted() {\r\n    //获取支付信息\r\n    this.getPayInfo();\r\n  },\r\n  methods: {\r\n    //立即支付按钮\r\n    async open() {\r\n      //生成一个二维码URL\r\n      let url = await QRCode.toDataURL(this.payInfo.codeUrl);\r\n      //第一个参数:即为内容区域\r\n      //第二个参数:标题\r\n      //第三个参数:组件的配置项\r\n      this.$alert(`<img src=${url}>`, \"请你微信扫码支付\", {\r\n        dangerouslyUseHTMLString: true, //将字符串转换为标签\r\n        center: true, //居中\r\n        showClose: false, //右上角的关闭按钮不显示\r\n        confirmButtonText: \"支付成功\", //确定按钮的文本\r\n        showCancelButton: true, //显示取消按钮\r\n        cancelButtonText: \"支付遇见问题\", //取消按钮的文本\r\n        closeOnClickModal: true, //点击遮罩层关闭messagebox\r\n        beforeClose: (action, instance, done) => {\r\n          //在消息盒子关闭之前会触发\r\n          //action参数:可以区分用户点击的是取消【cancel】、确定【confirm】\r\n          //instance参数:当前消息框组件VC\r\n          //done参数：是一个函数,函数可以关闭消息盒子\r\n          if (action == \"confirm\" && this.code == 200) {\r\n            //清除定时器\r\n            clearInterval(this.timer);\r\n            //关闭盒子\r\n            done();\r\n            //路由跳转\r\n            this.$router.push(\"/paysuccess\");\r\n          } else if (action == \"cancel\" && this.code != 200) {\r\n            //清除定时器\r\n            clearInterval(this.timer);\r\n            //关闭盒子\r\n            done();\r\n            this.$message.error(\"支付遇见问题请联系超管豪哥\");\r\n          }\r\n        }\r\n      });\r\n      //查询支付结果,开启定时器每隔一段时间询问支付结果\r\n      this.timer = setInterval(async () => {\r\n        //发请求获取支付结果\r\n        let result = await reqPayResult(this.payInfo.orderId);\r\n        //返回数据当中：code=200代表支付成功  code=205未支付\r\n        if (result.code == 200) {\r\n          //支付成功了\r\n          //存储一下支付成功的code数值，通过他判断支付是否成功\r\n          this.code = result.code;\r\n          //清除定时器\r\n          clearInterval(this.timer);\r\n          //关闭messagebox\r\n          this.$msgbox.close();\r\n          //在路由跳转\r\n          this.$router.push(\"/paySuccess\");\r\n        } else {\r\n          //未支付\r\n          this.code = result.code;\r\n        }\r\n      }, 1000);\r\n    },\r\n    //获取支付信息\r\n    async getPayInfo() {\r\n      let result = await reqPayInfo(this.$route.query.orderId);\r\n      if (result.code == 200) {\r\n        this.payInfo = result.data;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style lang=\"less\" scoped>\r\n.pay-main {\r\n  margin-bottom: 20px;\r\n\r\n  .pay-container {\r\n    margin: 0 auto;\r\n    width: 1200px;\r\n\r\n    a:hover {\r\n      color: #4cb9fc;\r\n    }\r\n\r\n    .orange {\r\n      color: #e1251b;\r\n    }\r\n\r\n    .money {\r\n      font-size: 18px;\r\n    }\r\n\r\n    .zfb {\r\n      color: #e1251b;\r\n      font-weight: 700;\r\n    }\r\n\r\n    .checkout-tit {\r\n      padding: 10px;\r\n\r\n      .tit-txt {\r\n        font-size: 14px;\r\n        line-height: 21px;\r\n\r\n        .success-icon {\r\n          width: 30px;\r\n          height: 30px;\r\n          display: inline-block;\r\n          background: url(./images/icon.png) no-repeat 0 0;\r\n        }\r\n\r\n        .success-info {\r\n          padding: 0 8px;\r\n          line-height: 30px;\r\n          vertical-align: top;\r\n        }\r\n      }\r\n\r\n      .paymark {\r\n        overflow: hidden;\r\n        line-height: 26px;\r\n        text-indent: 38px;\r\n\r\n        .fl {\r\n          float: left;\r\n        }\r\n\r\n        .fr {\r\n          float: right;\r\n\r\n          .lead {\r\n            margin-bottom: 18px;\r\n            font-size: 15px;\r\n            font-weight: 400;\r\n            line-height: 22.5px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .checkout-info {\r\n      padding-left: 25px;\r\n      padding-bottom: 15px;\r\n      margin-bottom: 10px;\r\n      border: 2px solid #e1251b;\r\n\r\n      h4 {\r\n        margin: 9px 0;\r\n        font-size: 14px;\r\n        line-height: 21px;\r\n        color: #e1251b;\r\n      }\r\n\r\n      ol {\r\n        padding-left: 25px;\r\n        list-style-type: decimal;\r\n        line-height: 24px;\r\n        font-size: 14px;\r\n      }\r\n\r\n      ul {\r\n        padding-left: 25px;\r\n        list-style-type: disc;\r\n        line-height: 24px;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n\r\n    .checkout-steps {\r\n      border: 1px solid #ddd;\r\n      padding: 25px;\r\n\r\n      .hr {\r\n        height: 1px;\r\n        background-color: #ddd;\r\n      }\r\n\r\n      .step-tit {\r\n        line-height: 36px;\r\n        margin: 15px 0;\r\n      }\r\n\r\n      .step-cont {\r\n        margin: 0 10px 12px 20px;\r\n\r\n        ul {\r\n          font-size: 0;\r\n\r\n          li {\r\n            margin: 2px;\r\n            display: inline-block;\r\n            padding: 5px 20px;\r\n            border: 1px solid #ddd;\r\n            cursor: pointer;\r\n            line-height: 18px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .submit {\r\n      text-align: center;\r\n\r\n      .btn {\r\n        display: inline-block;\r\n        padding: 15px 45px;\r\n        margin: 15px 0 10px;\r\n        font: 18px \"微软雅黑\";\r\n        font-weight: 700;\r\n        border-radius: 0;\r\n        background-color: #e1251b;\r\n        border: 1px solid #e1251b;\r\n        color: #fff;\r\n        text-align: center;\r\n        vertical-align: middle;\r\n        cursor: pointer;\r\n        user-select: none;\r\n        text-decoration: none;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"],"mappings":";AAqIA;AACA,OAAAA,MAAA;AACA,SAAAC,UAAA,EAAAC,YAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACA;MACAC,OAAA;MACAC,IAAA;MACAC,KAAA;IACA;EACA;EACA;EACAC,QAAA;IACA;IACA,KAAAC,UAAA;EACA;EACAC,OAAA;IACA;IACA,MAAAC,KAAA;MACA;MACA,IAAAC,GAAA,SAAAZ,MAAA,CAAAa,SAAA,MAAAR,OAAA,CAAAS,OAAA;MACA;MACA;MACA;MACA,KAAAC,MAAA,aAAAH,GAAA;QACAI,wBAAA;QAAA;QACAC,MAAA;QAAA;QACAC,SAAA;QAAA;QACAC,iBAAA;QAAA;QACAC,gBAAA;QAAA;QACAC,gBAAA;QAAA;QACAC,iBAAA;QAAA;QACAC,WAAA,EAAAA,CAAAC,MAAA,EAAAC,QAAA,EAAAC,IAAA;UACA;UACA;UACA;UACA;UACA,IAAAF,MAAA,sBAAAlB,IAAA;YACA;YACAqB,aAAA,MAAApB,KAAA;YACA;YACAmB,IAAA;YACA;YACA,KAAAE,OAAA,CAAAC,IAAA;UACA,WAAAL,MAAA,qBAAAlB,IAAA;YACA;YACAqB,aAAA,MAAApB,KAAA;YACA;YACAmB,IAAA;YACA,KAAAI,QAAA,CAAAC,KAAA;UACA;QACA;MACA;MACA;MACA,KAAAxB,KAAA,GAAAyB,WAAA;QACA;QACA,IAAAC,MAAA,SAAA/B,YAAA,MAAAG,OAAA,CAAA6B,OAAA;QACA;QACA,IAAAD,MAAA,CAAA3B,IAAA;UACA;UACA;UACA,KAAAA,IAAA,GAAA2B,MAAA,CAAA3B,IAAA;UACA;UACAqB,aAAA,MAAApB,KAAA;UACA;UACA,KAAA4B,OAAA,CAAAC,KAAA;UACA;UACA,KAAAR,OAAA,CAAAC,IAAA;QACA;UACA;UACA,KAAAvB,IAAA,GAAA2B,MAAA,CAAA3B,IAAA;QACA;MACA;IACA;IACA;IACA,MAAAG,WAAA;MACA,IAAAwB,MAAA,SAAAhC,UAAA,MAAAoC,MAAA,CAAAC,KAAA,CAAAJ,OAAA;MACA,IAAAD,MAAA,CAAA3B,IAAA;QACA,KAAAD,OAAA,GAAA4B,MAAA,CAAA7B,IAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}